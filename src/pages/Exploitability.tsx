
import { Badge } from "@/components/ui/badge";
import { SimpleMetricCard } from "@/components/SimpleMetricCard";
import { SimpleTable } from "@/components/SimpleTable";

const data = [
  { cveId: "CVE-2024-0001", epss: "97.4%", maturity: "High", description: "Remote code execution vulnerability" },
  { cveId: "CVE-2024-0002", epss: "82.1%", maturity: "Low", description: "SQL injection vulnerability" },
  { cveId: "CVE-2024-0003", epss: "65.3%", maturity: "Medium", description: "Cross-site scripting vulnerability" },
  { cveId: "CVE-2024-0004", epss: "23.7%", maturity: "Low", description: "Authentication bypass" }
];

const columns = [
  { key: "cveId", title: "CVE ID" },
  { 
    key: "epss", 
    title: "EPSS",
    render: (value: string) => {
      const score = parseFloat(value);
      const color = score > 80 ? "text-red-400" : score > 50 ? "text-yellow-400" : "text-green-400";
      return <span className={`font-semibold ${color}`}>{value}</span>;
    }
  },
  {
    key: "maturity",
    title: "Exploit Code Maturity", 
    render: (value: string) => (
      <Badge variant={value === "High" ? "destructive" : value === "Medium" ? "default" : "secondary"}>
        {value}
      </Badge>
    )
  },
  { key: "description", title: "Description" }
];

export default function Exploitability() {
  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-3xl font-bold">Exploitability Scoring</h1>
        <p className="text-muted-foreground">EPSS scores and exploit code maturity</p>
      </div>

      <SimpleTable columns={columns} data={data} title="CVE Exploitability Analysis" />

      <div className="grid grid-cols-1 md:grid-cols-3 gap-6">
        <SimpleMetricCard title="High EPSS (>80%)" value={127} subtitle="Immediate attention" color="red" />
        <SimpleMetricCard title="Medium EPSS (50-80%)" value={345} subtitle="Monitor closely" color="yellow" />
        <SimpleMetricCard title="Low EPSS (<50%)" value={1234} subtitle="Standard monitoring" color="green" />
      </div>
    </div>
  );
}
