
const exploitabilityData = [
  {
    host: "10.168.50.77",
    cumulativeExploitability: "876",
    criticalCount: "161",
    highCount: "46",
    mediumCount: "10",
    lowCount: "39",
    totalVulnerabilities: "350"
  },
  {
    host: "10.168.50.140",
    cumulativeExploitability: "678",
    criticalCount: "83",
    highCount: "65",
    mediumCount: "31",
    lowCount: "52",
    totalVulnerabilities: "344"
  }
];

const columns = [
  { key: "host", title: "Host" },
  { 
    key: "cumulativeExploitability", 
    title: "Cumulative Exploitability",
    render: (value: string) => (
      <span className="font-bold text-red-500">{value}</span>
    )
  },
  { 
    key: "criticalCount", 
    title: "Critical Count",
    render: (value: string) => (
      <span className="font-semibold text-red-500">{value}</span>
    )
  },
  { 
    key: "highCount", 
    title: "High Count",
    render: (value: string) => (
      <span className="font-semibold text-orange-500">{value}</span>
    )
  },
  { 
    key: "mediumCount", 
    title: "Medium Count",
    render: (value: string) => (
      <span className="font-semibold text-yellow-500">{value}</span>
    )
  },
  { 
    key: "lowCount", 
    title: "Low Count",
    render: (value: string) => (
      <span className="font-semibold text-green-500">{value}</span>
    )
  },
  { key: "totalVulnerabilities", title: "Total Vulnerabilities" }
];

export default function MostExploitable() {
  return (
    <div className="space-y-6">
      <div>
        <h1 className="text-3xl font-bold">Most Exploitable</h1>
        <p className="text-muted-foreground">Hosts with highest risk of exploitation based on cumulative exploitability scores</p>
      </div>

      {/* Exploitability Score Calculation Description */}
      <div className="chart-container">
        <h3 className="text-lg font-semibold mb-4">Exploitability Score Calculation</h3>
        <p className="text-muted-foreground mb-4">
          This sheet identifies hosts with the highest risk of exploitation. The Cumulative Exploitability score combines EPSS, VPR, and KEV metrics for all vulnerabilities on each host. Higher scores indicate targets that should be prioritized for remediation.
        </p>
      </div>

      {/* Most Exploitable Hosts Table */}
      <div className="chart-container">
        <h3 className="text-lg font-semibold mb-4">Most Exploitable Hosts</h3>
        <div className="overflow-x-auto">
          <table className="w-full">
            <thead>
              <tr className="border-b border-border">
                {columns.map((col) => (
                  <th key={col.key} className="text-left py-3 px-4">{col.title}</th>
                ))}
              </tr>
            </thead>
            <tbody>
              {exploitabilityData.map((row, index) => (
                <tr key={index} className="border-b border-border/50 hover:bg-muted/20">
                  {columns.map((col) => (
                    <td key={col.key} className="py-3 px-4">
                      {col.render ? col.render(row[col.key as keyof typeof row]) : row[col.key as keyof typeof row]}
                    </td>
                  ))}
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      </div>
    </div>
  );
}
